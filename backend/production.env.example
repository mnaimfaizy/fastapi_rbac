#############################################
# FastAPI environment variables - Production
#############################################
MODE=production
PROJECT_NAME=fastapi-rbac
ENCRYPT_KEY=UIEhd2CCUoTRt6qNiDWA9mO57IdaLwcefGkDIf9WKFU=
JWT_REFRESH_SECRET_KEY=iYfWj8oCqXcuzFDLuV7RJdeAQYjG7jwhTra9kkFmxQ0T99nu76P_TVtN21eisIqj1VtgvVOBLKXD24CGU4Tv-A
JWT_RESET_SECRET_KEY=s9JVOshell3UZ4frL1hlQ7V9LiLGRGkwYroa2WxcEQLl4BcLXrgmma5fRROXMYa3
BACKEND_CORS_ORIGINS=["https://your-production-domain.com"]
TOKEN_ISSUER=fastapi_rbac
TOKEN_AUDIENCE=fastapi_rbac_users
USER_CHANGED_PASSWORD_DATE=2025-04-20
USERS_OPEN_REGISTRATION=false
DEBUG=false
LOG_LEVEL=INFO

#############################################
# Database Configuration - Supabase PostgreSQL
#############################################
# If using Supabase, you can get these values from your Supabase project settings
POSTGRES_URL="your-supabase-connection-string" # Get this from Supabase project settings
POSTGRES_PRISMA_URL="your-supabase-prisma-connection-string"
SUPABASE_URL="your-supabase-project-url"
POSTGRES_URL_NON_POOLING="your-supabase-non-pooling-connection-string"
SUPABASE_JWT_SECRET="your-supabase-jwt-secret"
POSTGRES_USER="postgres"
POSTGRES_PASSWORD="your-database-password"
POSTGRES_DATABASE="postgres"
SUPABASE_SERVICE_ROLE_KEY="your-supabase-service-role-key"
POSTGRES_HOST="your-supabase-host"
SUPABASE_ANON_KEY="your-supabase-anon-key"

# Legacy database variables - not needed when using Supabase
# DATABASE_TYPE=postgresql
# DATABASE_HOST=production_db_host
# DATABASE_USER=production_db_user
# DATABASE_PASSWORD=strong_production_password
# DATABASE_NAME=fastapi_prod_db
# DATABASE_CELERY_NAME=celery_schedule_jobs_prod
# DATABASE_PORT=5432

#############################################
# Email settings (Production)
#############################################
EMAILS_ENABLED=true
SMTP_HOST=smtp.production-mail-server.com
SMTP_PORT=587
SMTP_TLS=true
SMTP_USER=your-production-email@example.com
SMTP_PASSWORD=your-production-email-password
EMAILS_FROM_EMAIL=no-reply@your-domain.com
EMAILS_FROM_NAME=FastAPI RBAC

#############################################
# Redis variables (Production)
#############################################
REDIS_HOST=production_redis_host
REDIS_PASSWORD=strong_production_redis_password
REDIS_SSL=true
REDIS_PORT=6379

#############################################
# Celery Configuration (Production)
#############################################
# Broker and Backend URLs with SSL and authentication
CELERY_BROKER_URL=rediss://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/0
CELERY_RESULT_BACKEND=rediss://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/0

# Serialization Settings
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=["json"]
CELERY_TIMEZONE=UTC

# Task Execution Settings (Production optimized)
CELERY_TASK_TIME_LIMIT=1800  # 30 minutes
CELERY_TASK_SOFT_TIME_LIMIT=900  # 15 minutes
CELERY_WORKER_PREFETCH_MULTIPLIER=4
CELERY_TASK_ALWAYS_EAGER=false
CELERY_TASK_EAGER_PROPAGATES=false

# Beat Settings
CELERY_BEAT_SCHEDULER=django_celery_beat.schedulers:DatabaseScheduler
CELERY_BEAT_MAX_LOOP_INTERVAL=5

# Queue Settings
CELERY_TASK_DEFAULT_QUEUE=default
CELERY_TASK_DEFAULT_EXCHANGE=default
CELERY_TASK_DEFAULT_ROUTING_KEY=default

# Error Handling and Retry Settings
CELERY_TASK_ACKS_LATE=true
CELERY_TASK_REJECT_ON_WORKER_LOST=true
CELERY_TASK_DEFAULT_RETRY_DELAY=180
CELERY_TASK_MAX_RETRIES=3

# Monitoring Settings
CELERY_TASK_TRACK_STARTED=true
CELERY_TASK_SEND_SENT_EVENT=true
CELERY_WORKER_SEND_TASK_EVENTS=true

# Production Security Settings
CELERY_BROKER_USE_SSL=true
CELERY_REDIS_BACKEND_USE_SSL=true
CELERY_TASK_DEFAULT_RATE_LIMIT=10000/m
CELERY_WORKER_MAX_TASKS_PER_CHILD=1000

# Additional Production Settings
CELERY_WORKER_CONCURRENCY=8  # Number of worker processes
CELERY_WORKER_MAX_MEMORY_PER_CHILD=400000  # 400MB
CELERY_BROKER_POOL_LIMIT=100  # Connection pool size
CELERY_TASK_COMPRESSION=gzip  # Compress task messages
