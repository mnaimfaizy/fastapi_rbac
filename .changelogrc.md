# Changelog Configuration for FastAPI RBAC

## Overview

This file defines how changelogs are generated from Git commit history.
It uses conventional commit messages to categorize changes.

## Conventional Commit Format

All commits should follow the format:
```
<type>(<scope>): <subject>

[optional body]

[optional footer]
```

### Commit Types

The following commit types will be included in changelogs:

- **feat**: New features (appears in "New Features" section)
- **fix**: Bug fixes (appears in "Bug Fixes" section)
- **perf**: Performance improvements (appears in "Performance" section)
- **security**: Security enhancements (appears in "Security" section)
- **docs**: Documentation changes (appears in "Documentation" section)
- **refactor**: Code refactoring (appears in "Code Improvements" section)
- **test**: Test additions or improvements (appears in "Testing" section)
- **build**: Build system changes (appears in "Build System" section)
- **ci**: CI/CD changes (appears in "CI/CD" section)
- **chore**: Maintenance tasks (appears in "Maintenance" section)

### Breaking Changes

Breaking changes should be indicated with:
- `BREAKING CHANGE:` in the commit footer, or
- `!` after the type/scope (e.g., `feat!:` or `feat(api)!:`)

These will appear in a "Breaking Changes" section with high visibility.

## Scope Guidelines

Recommended scopes by component:

### Backend
- `api`: API endpoints and routes
- `auth`: Authentication and authorization
- `db`: Database models and migrations
- `crud`: CRUD operations
- `deps`: Dependency management
- `config`: Configuration management
- `worker`: Celery worker tasks
- `email`: Email functionality
- `security`: Security features

### Frontend
- `ui`: User interface components
- `auth`: Authentication flows
- `api`: API service calls
- `state`: Redux state management
- `types`: TypeScript types
- `routing`: React Router configuration
- `forms`: Form components
- `components`: Reusable components

### Infrastructure
- `docker`: Docker configuration
- `ci`: CI/CD workflows
- `deploy`: Deployment scripts
- `docs`: Documentation
- `release`: Release process

## Examples

### Feature Addition
```
feat(auth): add two-factor authentication support

Implemented TOTP-based 2FA for enhanced security.
Users can now enable 2FA in their profile settings.

Closes #123
```

### Bug Fix
```
fix(api): resolve rate limiting bypass vulnerability

Fixed issue where rate limiting could be bypassed
by using different case variations of email addresses.

Fixes #456
```

### Breaking Change
```
feat(api)!: redesign authentication API endpoints

BREAKING CHANGE: Authentication endpoints have been restructured.
- Renamed /auth/login to /auth/token
- Changed response format for /auth/user endpoint
- Removed deprecated /auth/legacy endpoint

Migration guide: docs/migration-v2.md
```

### Performance Improvement
```
perf(db): optimize user query with eager loading

Reduced N+1 queries by implementing eager loading
for user roles and permissions. Query time reduced
from ~500ms to ~50ms for typical user fetch.
```

### Documentation
```
docs(api): add comprehensive API endpoint documentation

- Added OpenAPI descriptions for all endpoints
- Included example requests and responses
- Documented error codes and edge cases
```

## Changelog Generation

### Automated Generation

The release script automatically generates changelogs:

```bash
# Generate changelog from last tag to HEAD
git log <last-tag>..HEAD --pretty=format:"- %s" > changelog.txt
```

### Manual Categorization

After generation, manually review and categorize commits:

1. Copy raw changelog to appropriate sections in `docs/release-notes.md`
2. Organize by type (New Features, Bug Fixes, etc.)
3. Add context and user-facing descriptions
4. Remove internal/chore commits if not relevant to users
5. Highlight breaking changes prominently

## Release Notes Template

```markdown
### v1.2.3 (YYYY-MM-DD)

**New Features:**
- Feature 1 description with user impact
- Feature 2 description with user impact

**Bug Fixes:**
- Bug fix 1 with issue reference (#123)
- Bug fix 2 with issue reference (#456)

**Performance:**
- Performance improvement 1 with metrics

**Security:**
- Security enhancement 1
- Security enhancement 2

**Breaking Changes:**
- Breaking change 1 with migration guide
- Breaking change 2 with migration guide

**Documentation:**
- Documentation update 1
- Documentation update 2

**Technical Details:**
- Internal change 1 (for developers)
- Internal change 2 (for developers)
```

## Best Practices

### Commit Message Guidelines

1. **Use present tense**: "Add feature" not "Added feature"
2. **Use imperative mood**: "Fix bug" not "Fixes bug"
3. **Be specific**: "Fix login rate limiting" not "Fix bug"
4. **Reference issues**: Include issue numbers when applicable
5. **Keep subject short**: Under 72 characters
6. **Add body for complex changes**: Explain what and why
7. **Use footer for metadata**: Breaking changes, issue references

### Changelog Guidelines

1. **User-focused**: Write for end users, not developers
2. **Action-oriented**: Focus on what users can now do
3. **Complete**: Include all notable changes
4. **Organized**: Group related changes together
5. **Searchable**: Use consistent terminology
6. **Versioned**: Always associate with a specific version
7. **Dated**: Include release date in ISO format (YYYY-MM-DD)

### Version Bumping Rules

Based on Semantic Versioning:

- **Patch** (0.0.X): Bug fixes, minor improvements
  - Examples: `fix:`, `perf:`, `docs:`
  
- **Minor** (0.X.0): New features, backward-compatible
  - Examples: `feat:` without breaking changes
  
- **Major** (X.0.0): Breaking changes, major rewrites
  - Examples: `feat!:`, `BREAKING CHANGE:` in footer

## Tools and Automation

### Recommended Tools

1. **commitizen**: Interactive commit message creation
   ```bash
   npm install -g commitizen cz-conventional-changelog
   git cz
   ```

2. **conventional-changelog**: Automated changelog generation
   ```bash
   npm install -g conventional-changelog-cli
   conventional-changelog -p angular -i CHANGELOG.md -s
   ```

3. **standard-version**: Automated versioning and changelog
   ```bash
   npm install -g standard-version
   standard-version
   ```

### Git Hooks

Consider adding a commit-msg hook to validate format:

```bash
#!/bin/sh
# .git/hooks/commit-msg

if ! grep -qE '^(feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert)(\(.+\))?: .+' "$1"; then
    echo "Commit message does not follow conventional format"
    echo "Format: <type>(<scope>): <subject>"
    exit 1
fi
```

## References

- [Conventional Commits](https://www.conventionalcommits.org/)
- [Semantic Versioning](https://semver.org/)
- [Keep a Changelog](https://keepachangelog.com/)
- [Angular Commit Guidelines](https://github.com/angular/angular/blob/main/CONTRIBUTING.md#commit)
